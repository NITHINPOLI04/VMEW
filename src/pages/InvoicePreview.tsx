import React, { useState, useEffect, useRef } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useReactToPrint } from 'react-to-print';
import { Download, Printer, Save, Edit, ArrowLeft } from 'lucide-react';
import { useInvoiceStore } from '../stores/invoiceStore';
import { useTemplateStore } from '../stores/templateStore';
import { jsPDF } from 'jspdf';
import 'jspdf-autotable';
import { InvoiceFormData } from '../types';
import { toast } from 'react-hot-toast';

const InvoicePreview: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { fetchInvoice, createInvoice, updateInvoice } = useInvoiceStore();
  const { letterhead, defaultInfo } = useTemplateStore();
  
  const [invoice, setInvoice] = useState<InvoiceFormData | null>(null);
  const [loading, setLoading] = useState(true);
  const [isTemp, setIsTemp] = useState(false);
  
  const invoiceRef = useRef<HTMLDivElement>(null);
  
  useEffect(() => {
    const loadInvoice = async () => {
      setLoading(true);
      
      try {
        if (id === 'temp') {
          const tempData = localStorage.getItem('invoicePreviewData');
          
          if (tempData) {
            setInvoice(JSON.parse(tempData));
            setIsTemp(true);
          } else {
            toast.error('No preview data found');
            navigate('/generate-invoice');
          }
        } else {
          const data = await fetchInvoice(id as string);
          setInvoice(data);
          setIsTemp(false);
        }
      } catch (error) {
        console.error('Error loading invoice:', error);
        toast.error('Failed to load invoice');
        navigate('/invoice-library');
      } finally {
        setLoading(false);
      }
    };
    
    loadInvoice();
  }, [id, fetchInvoice, navigate]);
  
  const handlePrint = useReactToPrint({
    content: () => invoiceRef.current,
    documentTitle: `Invoice_${invoice?.invoiceNumber}`,
    removeAfterPrint: true,
    onBeforeGetContent: () => {
      if (invoiceRef.current) {
        invoiceRef.current.classList.add('print-mode');
      }
      return Promise.resolve();
    },
    onAfterPrint: () => {
      if (invoiceRef.current) {
        invoiceRef.current.classList.remove('print-mode');
      }
    }
  });
  
  const handleGeneratePDF = () => {
    if (!invoice) return;
    
    try {
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4'
      });
      
      pdf.setFont('helvetica');
      
      const margin = 15;
      const pageWidth = 210;
      const pageHeight = 297;
      const contentWidth = pageWidth - (margin * 2);
      
      let yPos = 10;

      // Add the logo slightly to the left of the margin
      const logoBase64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QC8RXhpZgAASUkqAAgAAAAGABIBAwABAAAAAQAAABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAgAAABMCAwABAAAAAQAAAGmHBAABAAAAZgAAAAAAAABgAAAAAQAAAGAAAAABAAAABgAAkAcABAAAADAyMTABkQcABAAAAAECAwAAoAcABAAAADAxMDABoAMAAQAAAP//AAACoAMAAQAAAPQBAAADoAMAAQAAAPQBAAAAAAAA/+EOQmh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA2LTEyPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmNmYzQ2NDg4LWMzYWEtNGYxMC04MWRkLWNlZTk3Y2RjMzExMDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5TT0xVVElPTlMgT04gQk9BUkQgLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPlBvbGltZXJhIE5pdGhpbjwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3FLS0tuNXdVIHVzZXI9VUFGYkthcG8zVWsgYnJhbmQ9QkFGYktRaC1tUGcgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0ndyc/Pv/bAEMABgQFBgUEBgYFBgcHBggKEAoKCQkKFA4PDBAXFBgYFxQWFhodJR8aGyMcFhYgLCAjJicpKikZHy0wLSgwJSgpKP/bAEMBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/AABEIAfQB9AMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APqmiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKq6nqFppdjLeahcR29tEu55JGwAK+dviD+0esTy2ng21WQglftlwOD7qv+NVGDlsTKajufSdFfAWs/E/xjq8jtd69egMfuRSbFH0ArOt/G/ie3lWWLX9SV16H7Qx/rW31aXcx+sxP0Oor4w8H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BRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9k=";
      const logoWidth = 30; // Width of the logo in mm
      const logoHeight = 30; // Height of the logo in mm
      const logoX = margin - 5; // Shift logo 5mm to the left of the margin
      const logoY = 3; // Start at the top

      pdf.addImage(logoBase64, 'PNG', logoX, logoY, logoWidth, logoHeight);

      // Center the company information
      const textWidth = contentWidth; // Use the full content width for centering
      const textStartX = margin; // Start at the margin, but we'll center the text

      // Company Name
      pdf.setFontSize(20);
      pdf.setFont('helvetica', 'bold');
      pdf.setTextColor(13, 71, 161);
      const companyName = letterhead?.companyName || 'Venkateswara Marine Electrical Works';
      const companyNameWidth = pdf.getTextWidth(companyName);
      const companyNameX = (pageWidth - companyNameWidth) / 2; // Center the text
      pdf.text(companyName, companyNameX, yPos + 5);

      yPos += 10;
      pdf.setFontSize(10);
      pdf.setTextColor(0, 0, 0);

      // GST Number
      pdf.setFont('helvetica', 'bold');
      const gstLabel = 'GST No: ';
      const gstValue = letterhead?.gstNo || '37AGIPP2674H2Z0';
      const gstText = `${gstLabel}${gstValue}`;
      const gstTextWidth = pdf.getTextWidth(gstText);
      const gstTextX = (pageWidth - gstTextWidth) / 2; // Center the text

      pdf.text(gstLabel, gstTextX, yPos);
      pdf.setFont('helvetica', 'normal');
      pdf.text(gstValue, gstTextX + pdf.getTextWidth(gstLabel), yPos);
      yPos += 5;

      // Address Section
      const addressLabel = 'Address:';
      const addressValue = letterhead?.address || 'D.No.9-23-3/6, CBM Compound, Flat No. 203, Kamal Enclaves, Visakhapatnam - 03';
      const addressText = `${addressLabel} ${addressValue}`;
      const addressLines = pdf.splitTextToSize(addressText, textWidth);
      const addressTextWidth = pdf.getTextWidth(addressLines[0]);
      const addressTextX = (pageWidth - addressTextWidth) / 2; // Center the text

      pdf.setFont('helvetica', 'bold');
      pdf.text(addressLabel, addressTextX, yPos);

      pdf.setFont('helvetica', 'normal');
      const addressValueStartX = addressTextX + pdf.getTextWidth(addressLabel) + 1;
      const addressValueLines = pdf.splitTextToSize(addressValue, textWidth - pdf.getTextWidth(addressLabel) - 1);
      pdf.text(addressValueLines, addressValueStartX, yPos);
      yPos += addressValueLines.length * 4;

      // Workshop Section
      const workshopLabel = 'Workshop:';
      const workshopValue = letterhead?.workshop || 'Plot No.2E, Industrial Cluster, Pudi, Rambilli (M), Visakhapatnam - 11';
      const workshopText = `${workshopLabel} ${workshopValue}`;
      const workshopLines = pdf.splitTextToSize(workshopText, textWidth);
      const workshopTextWidth = pdf.getTextWidth(workshopLines[0]);
      const workshopTextX = (pageWidth - workshopTextWidth) / 2; // Center the text

      pdf.setFont('helvetica', 'bold');
      pdf.text(workshopLabel, workshopTextX, yPos);

      pdf.setFont('helvetica', 'normal');
      const workshopValueStartX = workshopTextX + pdf.getTextWidth(workshopLabel) + 1;
      const workshopValueLines = pdf.splitTextToSize(workshopValue, textWidth - pdf.getTextWidth(workshopLabel) - 1);
      pdf.text(workshopValueLines, workshopValueStartX, yPos);
      yPos += workshopValueLines.length * 4;

      // Email and Cell Section
      const emailLabel = 'Email:';
      const emailValue = letterhead?.email || 'vmew10n@gmail.com';
      const cellLabel = 'Cell:';
      const cellValue = letterhead?.cell || '9848523264';
      const separator = '  |  ';

      pdf.setFont('helvetica', 'bold');
      const emailLabelWidth = pdf.getTextWidth(emailLabel);
      const cellLabelWidth = pdf.getTextWidth(cellLabel);

      pdf.setFont('helvetica', 'normal');
      const emailValueWidth = pdf.getTextWidth(emailValue);
      const cellValueWidth = pdf.getTextWidth(cellValue);
      const separatorWidth = pdf.getTextWidth(separator);

      const totalWidth =
        emailLabelWidth +
        emailValueWidth +
        separatorWidth +
        cellLabelWidth +
        cellValueWidth;

      const startX = (pageWidth - totalWidth) / 2; // Center the entire line

      let currentX = startX;

      pdf.setFont('helvetica', 'bold');
      pdf.text(emailLabel, currentX, yPos);
      currentX += emailLabelWidth;

      pdf.setFont('helvetica', 'normal');
      pdf.text(emailValue, currentX, yPos);
      currentX += emailValueWidth;

      pdf.text(separator, currentX, yPos);
      currentX += separatorWidth;

      pdf.setFont('helvetica', 'bold');
      pdf.text(cellLabel, currentX, yPos);
      currentX += cellLabelWidth;

      pdf.setFont('helvetica', 'normal');
      pdf.text(cellValue, currentX, yPos);

      yPos += 5;

      // Adjust yPos to ensure content below starts after the logo and text
      yPos = Math.max(yPos, logoY + logoHeight + 5);

      pdf.setLineWidth(0.5);
      pdf.setDrawColor(13, 71, 161);
      pdf.line(5, yPos, pageWidth - 5, yPos);
      yPos += 8;
      yPos = Math.min(yPos, 50);
      
      pdf.setLineWidth(0.2);
      pdf.setDrawColor(0, 0, 0); 
      pdf.setFontSize(10);
      pdf.setFont('helvetica', 'bold');
      pdf.setTextColor(0, 0, 0);
      
      pdf.text(`Invoice No: ${invoice.invoiceNumber}`, margin, yPos);
      pdf.text(`Date: ${new Date(invoice.date).toLocaleDateString('en-GB')}`, margin, yPos + 5);
      
      pdf.text(`PAN No: ${defaultInfo?.panNo || 'AGIPP2674H'}`, pageWidth - margin, yPos, { align: 'right' });
      pdf.text(`MSME No: ${defaultInfo?.msmeNo || 'UDYAM-AP-10-000719'}`, pageWidth - margin, yPos + 5, { align: 'right' });
      
      yPos += 10;
      
      const buyerLines = [
        { label: "Name:", value: invoice.buyerName },
        ...invoice.buyerAddress.split('\n').map((line, i) => ({
          label: i === 0 ? "Address:" : "", value: line
        })),
        { label: "GST No:", value: invoice.buyerGst }
      ];

      const rightSideLines = [
        { label: "Vessel:", value: invoice.vessel || "" },
        { label: "E-way Bill No:", value: invoice.ewayBillNo || "" },
        { label: "P.O No:", value: invoice.poNumber || "" },
        { label: "DC No:", value: invoice.dcNumber || "" }
      ];

      const buyerBoxHeight = Math.max(
        buyerLines.length * 4 + 10,
        rightSideLines.length * 4 + 10,
        25
      );

      const leftBoxWidth = contentWidth * 0.55;
      const rightBoxWidth = contentWidth * 0.45;

      pdf.rect(margin, yPos, leftBoxWidth, buyerBoxHeight);
      pdf.setFontSize(11);
      pdf.setFont('helvetica', 'bold');
      pdf.text('Buyer Details', margin + 2, yPos + 5);

      let buyerY = yPos + 10;
      pdf.setFontSize(10);

      buyerLines.forEach(({ label, value }) => {
        if (buyerY < yPos + buyerBoxHeight - 2) {
          const labelX = margin + 2;
          const valueX = labelX + pdf.getTextWidth(label) + 1;

          pdf.setFont('helvetica', 'bold');
          pdf.text(label, labelX, buyerY);

          pdf.setFont('helvetica', 'normal');
          pdf.text(value, valueX, buyerY);

          buyerY += 4;
        }
      });

      const rightBoxX = margin + leftBoxWidth;
      pdf.rect(rightBoxX, yPos, rightBoxWidth, buyerBoxHeight);

      let rightY = yPos + 8;
      rightSideLines.forEach(({ label, value }) => {
        if (rightY < yPos + buyerBoxHeight - 2) {
          const labelX = rightBoxX + 2;
          const valueX = labelX + pdf.getTextWidth(label) + 1;

          pdf.setFont('helvetica', 'bold');
          pdf.text(label, labelX, rightY);

          pdf.setFont('helvetica', 'normal');
          pdf.text(value, valueX, rightY);

          rightY += 4;
        }
      });
      
      yPos += buyerBoxHeight + 5;
      
      let tableHeaders: string[];
      
      if (invoice.taxType === 'igst') {
        tableHeaders = [
          'Sl.\nNo.',
          'Description of Goods',
          'HSN/SAC\nCode',
          'Qty',
          'Unit',
          'Rate',
          'Taxable\nAmount',
          'IGST\n%',
          'IGST\nAmt.'
        ];
      } else {
        tableHeaders = [
          'Sl.\nNo.',
          'Description of Goods',
          'HSN/SAC\nCode',
          'Qty',
          'Unit',
          'Rate',
          'Taxable\nAmount',
          'SGST\n%',
          'SGST\nAmt.',
          'CGST\n%',
          'CGST\nAmt.'
        ];
      }
      
      let tableData: string[][];
      
      if (invoice.taxType === 'igst') {
        tableData = invoice.items.map((item, index) => [
          (index + 1).toString(),
          item.description,
          item.hsnSacCode,
          item.quantity.toString(),
          item.unit,
          item.rate.toFixed(2),
          item.taxableAmount.toFixed(2),
          `${item.igstPercentage}%`,
          item.igstAmount.toFixed(2)
        ]);
      } else {
        tableData = invoice.items.map((item, index) => [
          (index + 1).toString(),
          item.description,
          item.hsnSacCode,
          item.quantity.toString(),
          item.unit,
          item.rate.toFixed(2),
          item.taxableAmount.toFixed(2),
          `${item.sgstPercentage}%`,
          item.sgstAmount.toFixed(2),
          `${item.cgstPercentage}%`,
          item.cgstAmount.toFixed(2)
        ]);
      }
      
      const totalTaxableAmount = invoice.items.reduce((sum, item) => sum + item.taxableAmount, 0);
      const totalSgst = invoice.items.reduce((sum, item) => sum + item.sgstAmount, 0);
      const totalCgst = invoice.items.reduce((sum, item) => sum + item.cgstAmount, 0);
      const totalIgst = invoice.items.reduce((sum, item) => sum + item.igstAmount, 0);
      
      if (invoice.taxType === 'igst') {
        tableData.push([
          '', '', '', '', '', 'Total:', 
          totalTaxableAmount.toFixed(2), 
          '', 
          totalIgst.toFixed(2)
        ]);
      } else {
        tableData.push([
          '', '', '', '', '', 'Total:', 
          totalTaxableAmount.toFixed(2), 
          '', 
          totalSgst.toFixed(2), 
          '', 
          totalCgst.toFixed(2)
        ]);
      }
      
      let columnStyles: any;
      
      if (invoice.taxType === 'igst') {
        columnStyles = {
          0: { halign: 'center', cellWidth: 10 },
          1: { halign: 'left', cellWidth: 75 },
          2: { halign: 'center', cellWidth: 15 },
          3: { halign: 'center', cellWidth: 10 },
          4: { halign: 'center', cellWidth: 10 },
          5: { halign: 'right', cellWidth: 15 },
          6: { halign: 'right', cellWidth: 18 },
          7: { halign: 'center', cellWidth: 12 },
          8: { halign: 'right', cellWidth: 15 }
        };
      } else {
        columnStyles = {
          0: { halign: 'center', cellWidth: 7 },
          1: { halign: 'left', cellWidth: 55 },
          2: { halign: 'center', cellWidth: 15 },
          3: { halign: 'center', cellWidth: 8 },
          4: { halign: 'center', cellWidth: 8 },
          5: { halign: 'right', cellWidth: 15 },
          6: { halign: 'right', cellWidth: 18 },
          7: { halign: 'center', cellWidth: 12 },
          8: { halign: 'right', cellWidth: 15 },
          9: { halign: 'center', cellWidth: 12 },
          10: { halign: 'right', cellWidth: 15 }
        };
      }
      
      (pdf as any).autoTable({
        head: [tableHeaders],
        body: tableData,
        startY: yPos,
        margin: { left: margin, right: margin },
        styles: {
          fontSize: 10,
          cellPadding: 1.5,
          lineColor: [0, 0, 0],
          lineWidth: 0.1,
          textColor: [0, 0, 0],
          overflow: 'linebreak'
        },
        headStyles: {
          fillColor: [70, 130, 180],
          textColor: [255, 255, 255],
          fontStyle: 'bold',
          halign: 'center',
          valign: 'middle'
        },
        columnStyles,
        didParseCell: (data: any) => {
          if (data.row.index === tableData.length - 1) {
            data.cell.styles.fontStyle = 'bold';
            data.cell.styles.fillColor = [240, 240, 240];
          }
        },
        theme: 'grid'
      });
      
      const finalY = (pdf as any).lastAutoTable.finalY + 5;
      
      const totalsBoxWidth = 55;
      const totalsBoxX = pageWidth - margin - totalsBoxWidth;
      let totalsY = finalY;
      
      const totalsBoxHeight = invoice.taxType === 'igst' ? 20 : 25;
      
      pdf.setLineWidth(0.2);
      pdf.rect(totalsBoxX, totalsY, totalsBoxWidth, totalsBoxHeight);
      
      pdf.setFontSize(10);
      pdf.setFont('helvetica', 'normal');
      
      let lineY = totalsY + 5;
      const labelX = totalsBoxX + 3;
      const valueX = totalsBoxX + totalsBoxWidth - 3;
      
      pdf.text('Total Taxable Amount:', labelX, lineY);
      pdf.text(`${totalTaxableAmount.toFixed(2)}/-`, valueX, lineY, { align: 'right' });
      lineY += 4;
      
      if (invoice.taxType === 'igst') {
        pdf.text('Total IGST:', labelX, lineY);
        pdf.text(`${totalIgst.toFixed(2)}/-`, valueX, lineY, { align: 'right' });
        lineY += 4;
      } else {
        pdf.text('Total SGST:', labelX, lineY);
        pdf.text(`${totalSgst.toFixed(2)}/-`, valueX, lineY, { align: 'right' });
        lineY += 4;
        
        pdf.text('Total CGST:', labelX, lineY);
        pdf.text(`${totalCgst.toFixed(2)}/-`, valueX, lineY, { align: 'right' });
        lineY += 4;
      }
      
      const grandTotalY = lineY;
      const grandTotalHeight = 6;
      pdf.setFillColor(70, 130, 180);
      pdf.rect(totalsBoxX, grandTotalY - 1, totalsBoxWidth, grandTotalHeight, 'F');
      
      pdf.setTextColor(255, 255, 255);
      pdf.setFont('helvetica', 'bold');
      pdf.setFontSize(10);
      pdf.text('Grand Total:', labelX, grandTotalY + 3);
      pdf.text(`${invoice.grandTotal.toFixed(2)}/-`, valueX, grandTotalY + 3, { align: 'right' });
      
      pdf.setTextColor(0, 0, 0);
      pdf.setFont('helvetica', 'normal');
      
      const amountWordsY = totalsY + totalsBoxHeight + 5;
      const amountWordsLabel = "Amount in Words:   ";
      const amountWordsValue = invoice.totalInWords;

      const fullText = `${amountWordsLabel}${amountWordsValue}`;
      const amountWordsLines = pdf.splitTextToSize(fullText, contentWidth - 6);

      const amountWordsBoxHeight = Math.max(6, amountWordsLines.length * 4 + 4);

      pdf.setLineWidth(0.2);
      pdf.rect(margin, amountWordsY, contentWidth, amountWordsBoxHeight);

      pdf.setFontSize(10);

      let wordsY = amountWordsY + 5;

      amountWordsLines.forEach((line: string, index: number) => {
        if (wordsY < amountWordsY + amountWordsBoxHeight - 2) {
          if (index === 0 && line.includes(amountWordsLabel)) {
            const labelWidth = pdf.getTextWidth(amountWordsLabel);
            const labelX = margin + 3;
            const valueX = labelX + labelWidth;

            pdf.setFont('helvetica', 'bold');
            pdf.text(amountWordsLabel, labelX, wordsY);

            pdf.setFont('helvetica', 'normal');
            pdf.text(line.substring(amountWordsLabel.length).trim(), valueX, wordsY);
          } else {
            pdf.setFont('helvetica', 'normal');
            pdf.text(line, margin + 3, wordsY);
          }

          wordsY += 4;
        }
      });
      
      const bottomY = amountWordsY + amountWordsBoxHeight + 5;
      
      const bankDetails = [
        { label: "Bank Name:", value: defaultInfo?.bankName || 'SBI' },
        { label: "A/C No:", value: defaultInfo?.accountNo || '30373757750' },
        { label: "IFSC Code:", value: defaultInfo?.ifscCode || 'SBIN0015580' },
        { label: "Branch:", value: defaultInfo?.branch || 'ASILMETTA' }
      ];
      
      const terms = defaultInfo?.terms || [
        'Goods once sold cannot be taken back.',
        'Interest @24% per annum will be charged on overdue accounts.',
        'Any dispute arising out of this transaction will be subject to Visakhapatnam jurisdiction.'
      ];
      
      const bankBoxHeight = bankDetails.length * 4 + 10;
      const termsBoxHeight = terms.length * 4 + 10;
      const maxBoxHeight = Math.max(bankBoxHeight, termsBoxHeight, 25);

      const leftBoxBottomWidth = contentWidth * 0.48;
      const rightBoxBottomWidth = contentWidth * 0.48;
      const boxGap = contentWidth * 0.04;
      
      pdf.setLineWidth(0.2);
      pdf.rect(margin, bottomY, leftBoxBottomWidth, maxBoxHeight);
      pdf.setFont('helvetica', 'bold');
      pdf.setFontSize(11);
      pdf.text('Bank Details', margin + 3, bottomY + 6);
      
      pdf.setFont('helvetica', 'normal');
      pdf.setFontSize(10);
      let bankY = bottomY + 11;
      bankDetails.forEach(({ label, value }) => {
        if (bankY < bottomY + maxBoxHeight - 2) {
          const labelX = margin + 3;
          const valueX = labelX + pdf.getTextWidth(label) + 1;

          pdf.setFont('helvetica', 'bold');
          pdf.text(label, labelX, bankY);

          pdf.setFont('helvetica', 'normal');
          pdf.text(value, valueX, bankY);

          bankY += 4;
        }
      });
      
      const rightBoxBottomX = margin + leftBoxBottomWidth + boxGap;
      pdf.rect(rightBoxBottomX, bottomY, rightBoxBottomWidth, maxBoxHeight);
      pdf.setFont('helvetica', 'bold');
      pdf.setFontSize(11);
      pdf.text('Terms & Conditions', rightBoxBottomX + 3, bottomY + 6);
      
      pdf.setFont('helvetica', 'normal');
      pdf.setFontSize(10);
      let termY = bottomY + 11;
      terms.forEach((term, index) => {
        if (termY < bottomY + maxBoxHeight - 2) {
          const termText = `${index + 1}. ${term}`;
          const termLines = pdf.splitTextToSize(termText, rightBoxBottomWidth - 6);
          termLines.forEach((line: string) => {
            if (termY < bottomY + maxBoxHeight - 2) {
              pdf.text(line, rightBoxBottomX + 3, termY);
              termY += 3;
            }
          });
        }
      });
      
      const fileName = `Invoice_${invoice.invoiceNumber.replace(/[\/\\]/g, '-')}.pdf`;
      pdf.save(fileName);
      toast.success('PDF generated successfully!');
      
    } catch (error) {
      console.error('Error generating PDF:', error);
      toast.error('Failed to generate PDF. Please try again.');
    }
  };
  
  const handleSaveInvoice = async () => {
    if (!invoice) return;
    
    try {
      if (isTemp) {
        const result = await createInvoice(invoice);
        localStorage.removeItem('invoicePreviewData');
        toast.success('Invoice saved successfully');
        navigate(`/invoice-preview/${result._id}`);
      } else {
        await updateInvoice(id as string, invoice);
        toast.success('Invoice updated successfully');
      }
    } catch (error) {
      toast.error('Failed to save invoice');
    }
  };
  
  const handleEditInvoice = () => {
    if (isTemp) {
      navigate('/generate-invoice');
    } else {
      navigate(`/generate-invoice?edit=${id}`);
    }
  };
  
  if (loading) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-900"></div>
      </div>
    );
  }
  
  if (!invoice) {
    return (
      <div className="text-center py-12">
        <h2 className="text-2xl font-bold text-slate-800 mb-2">Invoice Not Found</h2>
        <p className="text-slate-600 mb-4">The requested invoice could not be found.</p>
        <button
          onClick={() => navigate('/invoice-library')}
          className="inline-flex items-center px-4 py-2 bg-blue-900 text-white rounded-md"
        >
          <ArrowLeft className="mr-2 h-5 w-5" /> Back to Library
        </button>
      </div>
    );
  }
  
  return (
    <div className="pb-12">
      <div className="flex justify-between items-center mb-6">
        <div className="flex items-center">
          <button
            onClick={() => navigate(-1)}
            className="mr-4 p-2 hover:bg-slate-100 rounded-full"
          >
            <ArrowLeft className="h-5 w-5 text-slate-700" />
          </button>
          <h1 className="text-3xl font-bold text-slate-800">
            {isTemp ? 'Invoice Preview' : `Invoice #${invoice.invoiceNumber}`}
          </h1>
        </div>
        
        <div className="flex space-x-3">
          <button
            onClick={handleEditInvoice}
            className="btn-secondary"
          >
            <Edit className="mr-2 h-5 w-5" /> Edit
          </button>
          
          {isTemp && (
            <button
              onClick={handleSaveInvoice}
              className="btn-success"
            >
              <Save className="mr-2 h-5 w-5" /> Save
            </button>
          )}
          
          <button
            onClick={handleGeneratePDF}
            className="btn-warning"
          >
            <Download className="mr-2 h-5 w-5" /> Download PDF
          </button>
          
          <button
            onClick={handlePrint}
            className="btn-primary"
          >
            <Printer className="mr-2 h-5 w-5" /> Print
          </button>
        </div>
      </div>
      
      <div className="bg-white rounded-lg shadow">
        <div 
          ref={invoiceRef} 
          className="p-6 bg-white transition-all duration-300"
        >
          <div className="letterhead mb-8 print:hidden">
            <div className="text-center border-b-2 border-blue-900 pb-4">
              <h1 className="text-3xl font-bold text-blue-900 mb-1">
                {letterhead?.companyName || 'Venkateswara Marine Electrical Works'}
              </h1>
              <p className="text-slate-600 mb-1">
                GST No: {letterhead?.gstNo || '37AGIPP2674H2Z0'}
              </p>
              <p className="text-slate-600 mb-1">
                {letterhead?.address || 'D.No.9-23-3/6, CBM Compound, Flat No. 203, Kamal Enclaves, Visakhapatnam - 03'}
              </p>
              <p className="text-slate-600 mb-1">
                Workshop: {letterhead?.workshop || 'Plot No.2E, Industrial Cluster, Pudi, Rambilli (M), Visakhapatnam - 11'}
              </p>
              <div className="flex justify-center space-x-4">
                <p className="text-slate-600">
                  Email: {letterhead?.email || 'vmew10n@gmail.com'}
                </p>
                <p className="text-slate-600">
                  Cell: {letterhead?.cell || '9848523264'}
                </p>
              </div>
            </div>
          </div>
          
          <div className="flex justify-between mb-6">
            <div>
              <h2 className="text-xl font-bold mb-1">TAX INVOICE</h2>
              <p className="text-sm">Invoice No: <span className="font-medium">{invoice.invoiceNumber}</span></p>
              <p className="text-sm">Date: <span className="font-medium">{new Date(invoice.date).toLocaleDateString('en-IN')}</span></p>
            </div>
            <div className="text-right">
              <p className="text-sm">PAN No: <span className="font-medium">{defaultInfo?.panNo || 'AGIPP2674H'}</span></p>
              <p className="text-sm">MSME No: <span className="font-medium">{defaultInfo?.msmeNo || 'UDYAM-AP-10-000719'}</span></p>
            </div>
          </div>
          
          <div className="mb-6 border border-slate-200 rounded-md p-4">
            <h3 className="font-bold border-b pb-2 mb-2">Buyer Details</h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <p className="text-sm font-medium">Name:</p>
                <p className="mb-2">{invoice.buyerName}</p>
                
                <p className="text-sm font-medium">Address:</p>
                <p className="mb-2 whitespace-pre-wrap">{invoice.buyerAddress}</p>
                
                <p className="text-sm font-medium">GST No:</p>
                <p className="mb-2">{invoice.buyerGst}</p>
              </div>
              <div>
                <p className="text-sm font-medium">Vessel:</p>
                <p className="mb-2">{invoice.vessel}</p>
                
                <p className="text-sm font-medium">E-way Bill No:</p>
                <p className="mb-2">{invoice.ewayBillNo}</p>
                
                <p className="text-sm font-medium">P.O. No:</p>
                <p className="mb-2">{invoice.poNumber}</p>
                
                <p className="text-sm font-medium">DC No:</p>
                <p>{invoice.dcNumber}</p>
              </div>
            </div>
          </div>
          
          <div className="mb-6 overflow-x-auto">
            <table className="min-w-full border border-slate-200">
              <thead>
                <tr className="bg-slate-50">
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-left text-xs font-medium text-slate-600 uppercase tracking-wider">
                    S. No.
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-left text-xs font-medium text-slate-600 uppercase tracking-wider">
                    Description of Goods
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-left text-xs font-medium text-slate-600 uppercase tracking-wider">
                    HSN/SAC Code
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-center text-xs font-medium text-slate-600 uppercase tracking-wider">
                    Qty
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-center text-xs font-medium text-slate-600 uppercase tracking-wider">
                    Unit
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-right text-xs font-medium text-slate-600 uppercase tracking-wider">
                    Rate
                  </th>
                  <th className="py-2 px-3 border-b border-r border-slate-200 text-right text-xs font-medium text-slate-600 uppercase tracking-wider">
                    Taxable Amount
                  </th>
                  {invoice.taxType === 'igst' ? (
                    <>
                      <th className="py-2 px-3 border-b border-r border-slate-200 text-center text-xs font-medium text-slate-600 uppercase tracking-wider">
                        IGST %
                      </th>
                      <th className="py-2 px-3 border-b border-slate-200 text-right text-xs font-medium text-slate-600 uppercase tracking-wider">
                        IGST Amount
                      </th>
                    </>
                  ) : (
                    <>
                      <th className="py-2 px-3 border-b border-r border-slate-200 text-center text-xs font-medium text-slate-600 uppercase tracking-wider">
                        SGST %
                      </th>
                      <th className="py-2 px-3 border-b border-r border-slate-200 text-right text-xs font-medium text-slate-600 uppercase tracking-wider">
                        SGST Amount
                      </th>
                      <th className="py-2 px-3 border-b border-r border-slate-200 text-center text-xs font-medium text-slate-600 uppercase tracking-wider">
                        CGST %
                      </th>
                      <th className="py-2 px-3 border-b border-slate-200 text-right text-xs font-medium text-slate-600 uppercase tracking-wider">
                        CGST Amount
                      </th>
                    </>
                  )}
                </tr>
              </thead>
              <tbody>
                {invoice.items.map((item, index) => (
                  <tr key={index} className={index % 2 === 0 ? 'bg-white' : 'bg-slate-50'}>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-slate-800">
                      {index + 1}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-slate-800">
                      {item.description}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-slate-800">
                      {item.hsnSacCode}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-center text-slate-800">
                      {item.quantity}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-center text-slate-800">
                      {item.unit}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-right text-slate-800">
                      {item.rate.toFixed(2)}
                    </td>
                    <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-right text-slate-800">
                      {item.taxableAmount.toFixed(2)}
                    </td>
                    {invoice.taxType === 'igst' ? (
                      <>
                        <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-center text-slate-800">
                          {item.igstPercentage}%
                        </td>
                        <td className="py-2 px-3 border-b border-slate-200 text-sm text-right text-slate-800">
                          {item.igstAmount.toFixed(2)}
                        </td>
                      </>
                    ) : (
                      <>
                        <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-center text-slate-800">
                          {item.sgstPercentage}%
                        </td>
                        <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-right text-slate-800">
                          {item.sgstAmount.toFixed(2)}
                        </td>
                        <td className="py-2 px-3 border-b border-r border-slate-200 text-sm text-center text-slate-800">
                          {item.cgstPercentage}%
                        </td>
                        <td className="py-2 px-3 border-b border-slate-200 text-sm text-right text-slate-800">
                          {item.cgstAmount.toFixed(2)}
                        </td>
                      </>
                    )}
                  </tr>
                ))}
              </tbody>
              <tfoot>
                <tr className="bg-slate-100">
                  <td colSpan={6} className="py-2 px-3 border-b border-r border-slate-200 text-right font-medium">
                    Total:
                  </td>
                  <td className="py-2 px-3 border-b border-r border-slate-200 text-right font-medium">
                    {invoice.items.reduce((sum, item) => sum + item.taxableAmount, 0).toFixed(2)}
                  </td>
                  {invoice.taxType === 'igst' ? (
                    <>
                      <td className="py-2 px-3 border-b border-r border-slate-200"></td>
                      <td className="py-2 px-3 border-b border-slate-200 text-right font-medium">
                        {invoice.items.reduce((sum, item) => sum + item.igstAmount, 0).toFixed(2)}
                      </td>
                    </>
                  ) : (
                    <>
                      <td className="py-2 px-3 border-b border-r border-slate-200"></td>
                      <td className="py-2 px-3 border-b border-r border-slate-200 text-right font-medium">
                        {invoice.items.reduce((sum, item) => sum + item.sgstAmount, 0).toFixed(2)}
                      </td>
                      <td className="py-2 px-3 border-b border-r border-slate-200"></td>
                      <td className="py-2 px-3 border-b border-slate-200 text-right font-medium">
                        {invoice.items.reduce((sum, item) => sum + item.cgstAmount, 0).toFixed(2)}
                      </td>
                    </>
                  )}
                </tr>
              </tfoot>
            </table>
          </div>
          
          <div className="mb-6 flex justify-end">
            <div className="w-80 border border-slate-200 rounded-md overflow-hidden">
              <div className="bg-slate-50 p-3 border-b border-slate-200">
                <div className="flex justify-between">
                  <span className="font-medium">Total Taxable Amount:</span>
                  <span>{invoice.items.reduce((sum, item) => sum + item.taxableAmount, 0).toFixed(2)}</span>
                </div>
              </div>
              <div className="p-3 border-b border-slate-200">
                {invoice.taxType === 'igst' ? (
                  <div className="flex justify-between">
                    <span className="font-medium">Total IGST:</span>
                    <span>{invoice.items.reduce((sum, item) => sum + item.igstAmount, 0).toFixed(2)}</span>
                  </div>
                ) : (
                  <>
                    <div className="flex justify-between mb-1">
                      <span className="font-medium">Total SGST:</span>
                      <span>{invoice.items.reduce((sum, item) => sum + item.sgstAmount, 0).toFixed(2)}</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="font-medium">Total CGST:</span>
                      <span>{invoice.items.reduce((sum, item) => sum + item.cgstAmount, 0).toFixed(2)}</span>
                    </div>
                  </>
                )}
              </div>
              <div className="p-3 bg-blue-900 text-white">
                <div className="flex justify-between text-lg">
                  <span className="font-bold">Grand Total:</span>
                  <span className="font-bold">{invoice.grandTotal.toFixed(2)}</span>
                </div>
              </div>
            </div>
          </div>
          
          <div className="mb-6 p-3 border border-slate-200 rounded-md bg-slate-50">
            <p className="text-sm"><span className="font-medium">Amount in Words:</span> {invoice.totalInWords}</p>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div className="border border-slate-200 rounded-md p-4">
              <h3 className="font-bold border-b pb-2 mb-2">Bank Details</h3>
              <p className="mb-1"><span className="font-medium">Bank Name:</span> {defaultInfo?.bankName || 'SBI'}</p>
              <p className="mb-1"><span className="font-medium">A/C No:</span> {defaultInfo?.accountNo || '30373757750'}</p>
              <p className="mb-1"><span className="font-medium">IFSC Code:</span> {defaultInfo?.ifscCode || 'SBIN0015580'}</p>
              <p><span className="font-medium">Branch:</span> {defaultInfo?.branch || 'ASILMETTA'}</p>
            </div>
            <div className="border border-slate-200 rounded-md p-4">
              <h3 className="font-bold border-b pb-2 mb-2">Terms & Conditions</h3>
              {defaultInfo?.terms.map((term, index) => (
                <p key={index} className="mb-1 text-sm">{index + 1}. {term}</p>
              )) || (
                <>
                  <p className="mb-1 text-sm">1. Goods once sold cannot be taken back.</p>
                  <p className="mb-1 text-sm">2. Interest @24% per annum will be charged on overdue accounts.</p>
                  <p className="text-sm">3. Any dispute arising out of this transaction will be subject to Visakhapatnam jurisdiction.</p>
                </>
              )}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default InvoicePreview;